<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.paint.Color?>

<BorderPane xmlns="http://javafx.com/javafx/8" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="controllers.Staff.BookingViewController"
            stylesheets="@../../styles/staff.css">
   
   <top>
      <VBox spacing="5">
         <padding>
            <Insets top="15" right="20" bottom="5" left="20"/>
         </padding>
         
         <HBox alignment="CENTER_LEFT" spacing="15">
            <Label text="Quản lý đặt lịch" style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #d88e3f;">
               <font>
                  <Font name="System Bold" size="24"/>
               </font>
            </Label>
            
            <Region HBox.hgrow="ALWAYS" />
            
            <HBox alignment="CENTER" spacing="10">
               <Label fx:id="currentDateLabel" text="Ngày hiện tại: 30/04/2025" style="-fx-font-size: 14px;">
                  <font>
                     <Font size="14"/>
                  </font>
               </Label>
               <Separator orientation="VERTICAL" />
               <Label fx:id="staffNameLabel" text="Nhân viên: Nguyễn Văn A" style="-fx-font-size: 14px;">
                  <font>
                     <Font size="14"/>
                  </font>
               </Label>
            </HBox>
         </HBox>
         
         <Separator />
      </VBox>
   </top>
   
   <center>
      <TabPane tabClosingPolicy="UNAVAILABLE">
         <tabs>
            <Tab text="Lịch hẹn hôm nay">
               <content>
                  <BorderPane>
                     <top>
                        <VBox spacing="10">
                           <padding>
                              <Insets top="15" right="20" bottom="10" left="20"/>
                           </padding>
                           
                           <HBox spacing="15" alignment="CENTER_LEFT">
                              <Label text="Ngày:" />
                              <DatePicker fx:id="datePicker" />
                              
                              <Button fx:id="todayButton" text="Hôm nay" onAction="#loadTodaySchedule" 
                                      style="-fx-background-color: #d88e3f; -fx-text-fill: white;">
                                 <font>
                                    <Font name="System Bold" size="12"/>
                                 </font>
                              </Button>
                              
                              <Separator orientation="VERTICAL" />
                              
                              <TextField fx:id="searchField" promptText="Tìm theo số điện thoại khách hàng" prefWidth="250" />
                              <Button text="Tìm kiếm" onAction="#searchBookings" 
                                      style="-fx-background-color: #1976D2; -fx-text-fill: white;" />
                              
                              <Region HBox.hgrow="ALWAYS" />
                              
                              <ComboBox fx:id="statusFilter" promptText="Lọc trạng thái" prefWidth="180" />
                              <Button text="Áp dụng" onAction="#applyFilters" 
                                      style="-fx-background-color: #1976D2; -fx-text-fill: white;" />
                           </HBox>
                           
                           <HBox spacing="10" alignment="CENTER_LEFT">
                              <Button fx:id="newBookingButton" text="Đặt lịch mới" onAction="#handleNewBooking" 
                                      style="-fx-background-color: #4CAF50; -fx-text-fill: white;">
                                 <font>
                                    <Font name="System Bold" size="12"/>
                                 </font>
                              </Button>
                              <Button text="Làm mới" onAction="#refreshBookings" 
                                      style="-fx-background-color: #1976D2; -fx-text-fill: white;" />
                           </HBox>
                        </VBox>
                     </top>
                     
                     <center>
                        <VBox spacing="10">
                           <padding>
                              <Insets top="0" right="20" bottom="10" left="20"/>
                           </padding>
                           
                           <TableView fx:id="bookingTable" VBox.vgrow="ALWAYS">
                              <columns>
                                 <TableColumn fx:id="idColumn" prefWidth="70" text="Mã đặt lịch" />
                                 <TableColumn fx:id="timeColumn" prefWidth="130" text="Thời gian" />
                                 <TableColumn fx:id="customerColumn" prefWidth="170" text="Khách hàng" />
                                 <TableColumn fx:id="phoneColumn" prefWidth="120" text="Số điện thoại" />
                                 <TableColumn fx:id="petColumn" prefWidth="110" text="Thú cưng" />
                                 <TableColumn fx:id="serviceColumn" prefWidth="170" text="Dịch vụ" />
                                 <TableColumn fx:id="statusColumn" prefWidth="130" text="Trạng thái" />
                                 <TableColumn fx:id="assignedStaffColumn" prefWidth="160" text="Nhân viên phụ trách" />
                              </columns>
                              <placeholder>
                                 <Label text="Không có lịch hẹn nào trong ngày này" />
                              </placeholder>
                           </TableView>
                        </VBox>
                     </center>
                     
                     <bottom>
                        <HBox spacing="20" style="-fx-background-color: #f5f5f5; -fx-padding: 10 20 20 20;">
                           <VBox spacing="5" HBox.hgrow="ALWAYS">
                              <Label text="Ghi chú:" style="-fx-font-weight: bold;" />
                              <TextArea fx:id="notesArea" prefHeight="100" wrapText="true" />
                           </VBox>
                           
                           <VBox spacing="15" alignment="CENTER" prefWidth="180">
                              <padding>
                                 <Insets top="15" right="0" bottom="0" left="0"/>
                              </padding>
                              
                              <Button fx:id="confirmArrivalButton" disable="true" maxWidth="Infinity" 
                                      text="Xác nhận đến" onAction="#confirmArrival"
                                      style="-fx-background-color: #FF9800; -fx-text-fill: white;">
                                 <font>
                                    <Font name="System Bold" size="12"/>
                                 </font>
                              </Button>
                                      
                              <Button fx:id="startButton" disable="true" maxWidth="Infinity" 
                                      text="Bắt đầu dịch vụ" onAction="#startService"
                                      style="-fx-background-color: #2196F3; -fx-text-fill: white;">
                                 <font>
                                    <Font name="System Bold" size="12"/>
                                 </font>
                              </Button>
                                      
                              <Button fx:id="completeButton" disable="true" maxWidth="Infinity" 
                                      text="Hoàn thành" onAction="#completeService"
                                      style="-fx-background-color: #4CAF50; -fx-text-fill: white;">
                                 <font>
                                    <Font name="System Bold" size="12"/>
                                 </font>
                              </Button>
                                      
                            
                           </VBox>
                        </HBox>
                     </bottom>
                  </BorderPane>
               </content>
            </Tab>
            
            <Tab text="Lịch hẹn sắp tới">
               <content>
                  <BorderPane>
                     <top>
                        <VBox spacing="10">
                           <padding>
                              <Insets top="15" right="20" bottom="10" left="20"/>
                           </padding>
                           
                           <HBox spacing="15" alignment="CENTER_LEFT">
                              <Label text="Xem từ:" />
                              <DatePicker fx:id="startDatePicker" />
                              
                              <Label text="Đến:" />
                              <DatePicker fx:id="endDatePicker" />
                              
                              <Button text="Xem" onAction="#viewDateRange" 
                                      style="-fx-background-color: #1976D2; -fx-text-fill: white;" />
                              
                              <Region HBox.hgrow="ALWAYS" />
                              
                              <ComboBox fx:id="upcomingStatusFilter" promptText="Lọc trạng thái" prefWidth="180" />
                              <Button text="Áp dụng" onAction="#applyUpcomingFilters" 
                                      style="-fx-background-color: #1976D2; -fx-text-fill: white;" />
                           </HBox>
                        </VBox>
                     </top>
                     
                     <center>
                        <VBox spacing="10">
                           <padding>
                              <Insets top="0" right="20" bottom="10" left="20"/>
                           </padding>
                           
                           <TableView fx:id="upcomingBookingTable" VBox.vgrow="ALWAYS">
                              <columns>
                                 <TableColumn fx:id="upcomingIdColumn" prefWidth="70" text="Mã đặt lịch" />
                                 <TableColumn fx:id="upcomingDateColumn" prefWidth="110" text="Ngày" />
                                 <TableColumn fx:id="upcomingTimeColumn" prefWidth="80" text="Giờ" />
                                 <TableColumn fx:id="upcomingCustomerColumn" prefWidth="170" text="Khách hàng" />
                                 <TableColumn fx:id="upcomingPhoneColumn" prefWidth="120" text="Số điện thoại" />
                                 <TableColumn fx:id="upcomingPetColumn" prefWidth="110" text="Thú cưng" />
                                 <TableColumn fx:id="upcomingServiceColumn" prefWidth="170" text="Dịch vụ" />
                                 <TableColumn fx:id="upcomingStatusColumn" prefWidth="130" text="Trạng thái" />
                                 <TableColumn fx:id="upcomingStaffColumn" prefWidth="150" text="Nhân viên phụ trách" />
                              </columns>
                              <placeholder>
                                 <Label text="Không có lịch hẹn nào trong khoảng thời gian này" />
                              </placeholder>
                           </TableView>
                        </VBox>
                     </center>
                  </BorderPane>
               </content>
            </Tab>
         </tabs>
      </TabPane>
   </center>
   
 
   <HBox alignment="CENTER_RIGHT" spacing="10" style="-fx-background-color: #BBDEFB; -fx-border-color: #1976D2; -fx-border-width: 1 0 0 0;">
   <padding>
      <Insets top="10" right="20" bottom="10" left="20"/>
   </padding>
   
   <Label fx:id="statusMessageLabel" text="Sẵn sàng" style="-fx-text-fill: #333333;" />
   <Region HBox.hgrow="ALWAYS" />
   <Button fx:id="homeButton" text="Về trang chủ" onAction="#goToHome" 
          style="-fx-background-color: #d88e3f; -fx-text-fill: white; -fx-background-radius: 4; -fx-padding: 8 15;" />
   <Button text="Trợ giúp" onAction="#showHelp" 
          style="-fx-background-color: #DDDDDD; -fx-text-fill: #333333; -fx-background-radius: 4; -fx-padding: 8 15;" />
   <Button text="Thoát" onAction="#exitApplication" 
          style="-fx-background-color: #FFCDD2; -fx-text-fill: #B71C1C; -fx-background-radius: 4; -fx-padding: 8 15;" />
</HBox>
   
</BorderPane>